<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Shellscripting | Signal in the Static</title>
    <meta name="description" content="Small introduction to Shell programming">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
    
    <link rel="preload" href="/CompSci/assets/css/0.styles.b8e7b39e.css" as="style"><link rel="preload" href="/CompSci/assets/js/app.c8045a2e.js" as="script"><link rel="preload" href="/CompSci/assets/js/2.9ee3c665.js" as="script"><link rel="preload" href="/CompSci/assets/js/53.ec720d71.js" as="script"><link rel="preload" href="/CompSci/assets/js/14.86808d51.js" as="script"><link rel="prefetch" href="/CompSci/assets/js/10.26bc3856.js"><link rel="prefetch" href="/CompSci/assets/js/11.15eb1e49.js"><link rel="prefetch" href="/CompSci/assets/js/12.3cbe8c7b.js"><link rel="prefetch" href="/CompSci/assets/js/13.3480ac4e.js"><link rel="prefetch" href="/CompSci/assets/js/15.d7c9db1b.js"><link rel="prefetch" href="/CompSci/assets/js/16.ff2c41ec.js"><link rel="prefetch" href="/CompSci/assets/js/17.d08790df.js"><link rel="prefetch" href="/CompSci/assets/js/18.7ea1c003.js"><link rel="prefetch" href="/CompSci/assets/js/19.72bd3d26.js"><link rel="prefetch" href="/CompSci/assets/js/20.3e622964.js"><link rel="prefetch" href="/CompSci/assets/js/21.23a251af.js"><link rel="prefetch" href="/CompSci/assets/js/22.bd2856de.js"><link rel="prefetch" href="/CompSci/assets/js/23.e528aad0.js"><link rel="prefetch" href="/CompSci/assets/js/24.b0d3ea1e.js"><link rel="prefetch" href="/CompSci/assets/js/25.c378483a.js"><link rel="prefetch" href="/CompSci/assets/js/26.d5872c8d.js"><link rel="prefetch" href="/CompSci/assets/js/27.771b3ab1.js"><link rel="prefetch" href="/CompSci/assets/js/28.9d61d1fe.js"><link rel="prefetch" href="/CompSci/assets/js/29.09a23457.js"><link rel="prefetch" href="/CompSci/assets/js/3.c431bc3a.js"><link rel="prefetch" href="/CompSci/assets/js/30.665d2d0d.js"><link rel="prefetch" href="/CompSci/assets/js/31.8cddffef.js"><link rel="prefetch" href="/CompSci/assets/js/32.16d48c3c.js"><link rel="prefetch" href="/CompSci/assets/js/33.7a8b9219.js"><link rel="prefetch" href="/CompSci/assets/js/34.102acd60.js"><link rel="prefetch" href="/CompSci/assets/js/35.1bd3b9e2.js"><link rel="prefetch" href="/CompSci/assets/js/36.ea1f9892.js"><link rel="prefetch" href="/CompSci/assets/js/37.b0ce0d85.js"><link rel="prefetch" href="/CompSci/assets/js/38.17369777.js"><link rel="prefetch" href="/CompSci/assets/js/39.a011c528.js"><link rel="prefetch" href="/CompSci/assets/js/4.6e5a7a58.js"><link rel="prefetch" href="/CompSci/assets/js/40.6d64e855.js"><link rel="prefetch" href="/CompSci/assets/js/41.84cfb82f.js"><link rel="prefetch" href="/CompSci/assets/js/42.98e84372.js"><link rel="prefetch" href="/CompSci/assets/js/43.974d4dcc.js"><link rel="prefetch" href="/CompSci/assets/js/44.eeccf017.js"><link rel="prefetch" href="/CompSci/assets/js/45.ce9cf1c7.js"><link rel="prefetch" href="/CompSci/assets/js/46.c1e305c2.js"><link rel="prefetch" href="/CompSci/assets/js/47.a40978b9.js"><link rel="prefetch" href="/CompSci/assets/js/48.f226c492.js"><link rel="prefetch" href="/CompSci/assets/js/49.87dd191a.js"><link rel="prefetch" href="/CompSci/assets/js/5.89d03b7f.js"><link rel="prefetch" href="/CompSci/assets/js/50.f41ca47d.js"><link rel="prefetch" href="/CompSci/assets/js/51.84b80107.js"><link rel="prefetch" href="/CompSci/assets/js/52.0ad9f778.js"><link rel="prefetch" href="/CompSci/assets/js/54.dc38146f.js"><link rel="prefetch" href="/CompSci/assets/js/55.49d70205.js"><link rel="prefetch" href="/CompSci/assets/js/6.7ce2d28e.js"><link rel="prefetch" href="/CompSci/assets/js/7.676ea5e2.js"><link rel="prefetch" href="/CompSci/assets/js/8.b21d9508.js"><link rel="prefetch" href="/CompSci/assets/js/9.23216c5f.js">
    <link rel="stylesheet" href="/CompSci/assets/css/0.styles.b8e7b39e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/CompSci/" class="home-link router-link-active"><!----> <span class="site-name">Signal in the Static</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/CompSci/" class="nav-link">Home</a></div><div class="nav-item"><a href="/CompSci/blog/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="/CompSci/about/" class="nav-link">About</a></div> <div class="nav-item"><a role="button" aria-label="Switch to light mode" class="nav-link"><span>Switch theme</span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/CompSci/" class="nav-link">Home</a></div><div class="nav-item"><a href="/CompSci/blog/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="/CompSci/about/" class="nav-link">About</a></div> <div class="nav-item"><a role="button" aria-label="Switch to light mode" class="nav-link"><span>Switch theme</span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/CompSci/blog/" class="sidebar-link">Blog</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Notes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/CompSci/Books/" class="sidebar-heading clickable open"><span>Books</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/CompSci/Books/A_Mathematician-s_Lament.html" class="sidebar-link">A Mathematician's Lament</a></li><li><a href="/CompSci/Books/Art_of_problem_solving_Vol.1.html" class="sidebar-link">The Art of Problem Solving, Vol. 1: The Basics</a></li><li><a href="/CompSci/Books/ydkjs_notes.html" class="sidebar-link">You Don't Know JS: Notes</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/CompSci/CompSci/" class="sidebar-heading clickable"><span>CompSci</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/CompSci/Math/" class="sidebar-heading clickable"><span>Math</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/CompSci/Programming/" class="sidebar-heading clickable"><span>Programming</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-solarized-content content__default"><h2 id="variables-and-shebang"><a href="#variables-and-shebang" class="header-anchor">#</a> <strong>Variables and Shebang</strong></h2> <p>The Shell is the standard interface to every Unix and Linux system; users and administrators alike have experience with the shell, and combining commands into scripts is a natural progression. However, this is just a tip of the iceberg.</p> <p>I've spent some time lately learning about shell and writing scripts, and I've realized that the shell is actually a full programming language with variables and functions, and also more advanced structures such as arrays (including associative arrays) and being so directly linked to the kernel it has native IO primitives built into it's very syntax, as well as process and job control.</p> <p>I've planned this as a series of a few posts, and I'll try to be concise and on the point.</p> <p><em>So, what is shellscripting?</em></p> <p>Shellscripting is writing a series of commands for the shell to execute. It can combine lengthy and repetitive sequences of commands into a single and simple script, which can be stored and executed anytime, which is great for automating tasks. This reduces the effort required by the end user.</p> <p>Script's commands are being executed by the interpreter (shell), one by one, and everything you can type in the command line you can also put in the script.</p> <blockquote><p>Before running scripts, we need to set up permissions for execution with: <code>chmod 755 script.sh</code> We can then run the script with <code>./script.sh</code> via command line.</p></blockquote> <hr> <h3 id=""><a href="#" class="header-anchor">#</a></h3> <p><code>#!</code> (shebang) specifies binary of the shell (interpreter) we want to execute the script, for example: <code>#! /bin/bash</code>, <code>#! /bin/zsh</code> or for the best portability <code>#! /bin/sh</code> (this will run system shell).</p> <p><em>Note that the most of code in this series is tested only with <code>bash</code> and <code>zsh</code> shell, most sh scripts can be run by Bash without modification, but some stuff wont work.</em></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token shebang important">#! /bin/sh</span>
<span class="token function">sleep</span> <span class="token number">90</span>
</code></pre></div><p>When we execute the script that contains <code>#!</code> what actually happens is that interpreter is executed and the path used to call the script is passed as an argument. To confirm that, let's say we have <code>sleepy.sh</code> script, then we can run the script with <code>./sleepy.sh &amp;</code>, where <code>&amp;</code> is used (it seems) to return the PID of the script execution process, and then we can run <code>ps -fp [PID]</code> to see process info:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token environment constant">UID</span> PID <span class="token environment constant">PPID</span> C STIME TTY TIME CMD
<span class="token number">505</span> <span class="token number">65418</span> <span class="token number">59985</span> <span class="token number">0</span> <span class="token number">7</span>:09PM ttys000 <span class="token number">0</span>:00.01 /bin/zsh ./sleepy.sh
</code></pre></div><p>We can see here that <code>./sleepy.sh</code> is passed to my <code>/bin/zsh</code> binary as an argument.</p> <p>If a script doesn't contain <code>#!</code> commands are executed with default shell, but it's the best practice to be explicit as different shells have slightly varying syntax.</p> <p>Also, we don't have to use only shells as interpreters for scripts. We can also use other binaries like <code>python</code>:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token shebang important">#! /usr/bin/python</span>

print <span class="token string">&quot;This is a Python script&quot;</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>chmod 755 hi.py
./hi.py
This is a Python script
</code></pre></div><hr> <h3 id="variables"><a href="#variables" class="header-anchor">#</a> Variables</h3> <p>Variables are storage locations that have a name, and you can think of them as name-value pairs. Syntax used to create a variable is: <code>VARIABLE_NAME=&quot;Value&quot;</code>. It's important to note that variable names are case sensitive, and that, by convention, variable names should be all in uppercase. Also make sure to not use spaces after and before <code>=</code> sign, when declaring a variable.</p> <p><strong>By default all variables are global, also they have to be defined before used.</strong> Variables can be defined in the functions (we'll talk about them eventually), but we cannot access them before a function is called.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token keyword">function</span> <span class="token function-name function">var</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token assign-left variable">FUNC_VAR</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token comment"># FUNC_VAR is not defined at this point and this will not return anything</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$FUNC_VAR</span>
var <span class="token comment"># This is how we call a function in the shell</span>
<span class="token comment"># FUNC_VAR is now available because the function has been called</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$FUNC_VAR</span> <span class="token comment"># Output: 1</span>
</code></pre></div><p>Valid variable names can consist of letters, numbers, and underscores, except that number cannot be the first char in the name.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># Valid names</span>
<span class="token assign-left variable">DARK_JEDI</span><span class="token operator">=</span><span class="token string">&quot;Vader&quot;</span>
<span class="token assign-left variable">GR4Y_J3DI</span><span class="token operator">=</span><span class="token string">&quot;Ahsoka&quot;</span>
<span class="token assign-left variable">Regular_Jedi</span><span class="token operator">=</span><span class="token string">&quot;Obi-Wan&quot;</span>

<span class="token comment"># Invalid names</span>
<span class="token assign-left variable">3DARK_LORDS</span><span class="token operator">=</span><span class="token string">&quot;Vader Sidius Plagueis&quot;</span>
TWO-REBELS<span class="token operator">=</span><span class="token string">&quot;Solo Leia&quot;</span>
ONE@SHIP<span class="token operator">=</span><span class="token string">&quot;Ebon Hawk&quot;</span>
</code></pre></div><div class="language-shell extra-class"><pre class="language-shell"><code><span class="token shebang important">#! /bin/bash</span>
<span class="token assign-left variable">MY_SHELL</span><span class="token operator">=</span><span class="token string">&quot;zsh&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;I like the <span class="token variable">$MY_SHELL</span> shell&quot;</span> <span class="token comment"># Output: I like the zsh shell</span>
</code></pre></div><p>We can also enclose the variable name in curly braces:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">MY_SHELL</span><span class="token operator">=</span><span class="token string">&quot;zsh&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;I like the <span class="token variable">${MY_SHELL}</span> shell&quot;</span> <span class="token comment"># Output: I like the zsh shell</span>
</code></pre></div><p>Curly braces syntax is optional unless you need to precede or follow up the variable with additional data, like so:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">MY_SHELL</span><span class="token operator">=</span><span class="token string">&quot;bash&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;I'm <span class="token variable">${MY_SHELL}</span>ing on my keyboard!&quot;</span> <span class="token comment"># Output: I'm bashing on my keyboard.</span>
</code></pre></div><p>Without curly braces this wouldn't work as the interpreter will take that <code>ing</code> following the name variable as a part of the variable name.</p> <p>Another best practice is to enclose variables in quotes, when working with them, to prevent some unexpected side effects.</p> <p>We can also assign the output of the command to a variable:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">SERVER_NAME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">hostname</span><span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;You are running this script on <span class="token variable">${SERVER_NAME}</span>&quot;</span>
</code></pre></div><h4 id="local-variables"><a href="#local-variables" class="header-anchor">#</a> Local variables</h4> <p>Local vars are created with <code>local</code> keyword, and <strong>only functions can have the local variables</strong>, so they can only be accessed within the function where they're declared.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token keyword">function</span> <span class="token function-name function">myFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">local</span> <span class="token assign-left variable">LOCAL_VAR</span><span class="token operator">=</span><span class="token string">&quot; I'm locally scoped&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It's the best practice to use only local variables inside functions.</p> <hr> <p>That's it for now, I'll write a bit about tests and loops in the next one. Thanks for reading, and if you have any question, feel free to shoot me a message!</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/24/2020, 8:24:12 AM</span></div></footer> <!----> </main></div><div class="global-ui"><div style="visibility:hidden;display:none;"></div></div></div>
    <script src="/CompSci/assets/js/app.c8045a2e.js" defer></script><script src="/CompSci/assets/js/2.9ee3c665.js" defer></script><script src="/CompSci/assets/js/53.ec720d71.js" defer></script><script src="/CompSci/assets/js/14.86808d51.js" defer></script>
  </body>
</html>
